name: Run Daily Bot

on:
  schedule:
    # 毎日 JST 12:00 (UTC 3:00) に実行
    - cron: "0 3 * * *"
  workflow_dispatch:
    inputs:
      date:
        description: "日付 (YYYY-MM-DD形式、空欄で当日)"
        required: false
        type: string

jobs:
  run:
    runs-on: ubuntu-latest
    timeout-minutes: 5

    steps:
      - name: Run Bot
        run: |
          docker run --rm \
            -e DISCORD_WEBHOOK_URL="${{ secrets.DISCORD_WEBHOOK_URL }}" \
            -e DATA_SOURCE_URL="${{ secrets.DATA_SOURCE_URL }}" \
            ghcr.io/${{ github.repository_owner }}/daily-hacker-news-bot:latest \
            ${{ inputs.date }}
